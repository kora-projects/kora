/**
 * NOTE: This class is auto generated by Kora OpenAPI Generator (https://openapi-generator.tech) ({{{generatorVersion}}}).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */
package {{apiPackage}}


import ru.tinkoff.kora.config.common.extractor.ConfigValueExtractor

import ru.tinkoff.kora.http.client.common.interceptor.*
import ru.tinkoff.kora.http.common.auth.*
import ru.tinkoff.kora.http.client.common.auth.*


@ru.tinkoff.kora.common.annotation.Generated("openapi generator kora client")
@ru.tinkoff.kora.common.Module
interface ApiSecurity {
{{#authMethods}}

    @ru.tinkoff.kora.common.annotation.Generated("openapi generator kora client")
    class {{#lambda.classname}}{{name}}{{/lambda.classname}}

{{#isApiKey}}
    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}Config(config: ru.tinkoff.kora.config.common.Config, extractor: ConfigValueExtractor<String>): String {
        val configPath = "{{#hasSecurityConfigPrefix}}{{securityConfigPrefix}}.{{/hasSecurityConfigPrefix}}{{name}}"
        val configValue = config.get(configPath)
        return extractor.extract(configValue) ?: throw ru.tinkoff.kora.config.common.extractor.ConfigValueExtractionException.missingValueAfterParse(configValue)
    }

    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}HttpClientAuthInterceptor(@ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class) apiKey: String): HttpClientTokenProvider {
        val paramLocation = ApiKeyHttpClientInterceptor.ApiKeyLocation.{{#isKeyInQuery}}QUERY{{/isKeyInQuery}}{{#isKeyInHeader}}HEADER{{/isKeyInHeader}}{{#isKeyInCookie}}COOKIE{{/isKeyInCookie}}
        return ApiKeyHttpClientInterceptor(paramLocation, "{{keyParamName}}", apiKey)
    }
{{/isApiKey}}{{#isBasicBasic}}
    @ru.tinkoff.kora.common.annotation.Generated("openapi generator kora client")
    data class {{#lambda.classname}}{{name}}{{/lambda.classname}}Config(val username: String, val password: String)

    @ru.tinkoff.kora.common.DefaultComponent
    fun {{name}}Config(config: ru.tinkoff.kora.config.common.Config, extractor: ConfigValueExtractor<{{#lambda.classname}}{{name}}{{/lambda.classname}}Config>): {{#lambda.classname}}{{name}}{{/lambda.classname}}Config {
        val configPath = "{{#hasSecurityConfigPrefix}}{{securityConfigPrefix}}.{{/hasSecurityConfigPrefix}}{{name}}"
        val configValue = config.get(configPath)
        return extractor.extract(configValue) ?: throw ru.tinkoff.kora.config.common.extractor.ConfigValueExtractionException.missingValueAfterParse(configValue)
    }

    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}BasicAuthHttpClientTokenProvider(config: {{#lambda.classname}}{{name}}{{/lambda.classname}}Config): HttpClientTokenProvider {
        return BasicAuthHttpClientTokenProvider(config.username, config.password)
    }

    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}HttpClientAuthInterceptor(@ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class) provider: HttpClientTokenProvider): HttpClientInterceptor {
        return BasicAuthHttpClientInterceptor(provider)
    }
{{/isBasicBasic}}{{#isBasicBearer}}
    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}HttpClientAuthInterceptor(@ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class) tokenProvider: HttpClientTokenProvider): HttpClientInterceptor {
        return BearerAuthHttpClientInterceptor(tokenProvider)
    }
{{/isBasicBearer}}{{#isOAuth}}
    @ru.tinkoff.kora.common.DefaultComponent
    @ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class)
    fun {{name}}HttpClientAuthInterceptor(@ru.tinkoff.kora.common.Tag(ApiSecurity.{{#lambda.classname}}{{name}}{{/lambda.classname}}::class) tokenProvider: HttpClientTokenProvider): HttpClientInterceptor {
        return BearerAuthHttpClientInterceptor(tokenProvider)
    }
{{/isOAuth}}{{/authMethods}}
}
